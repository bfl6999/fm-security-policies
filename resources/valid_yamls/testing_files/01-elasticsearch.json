{
    "filename": "01-elasticsearch.yaml",
    "apiVersion": "apps_v1",
    "config": {
        "io_k8s_api_apps_v1_StatefulSet_apiVersion": "apps/v1",
        "io_k8s_api_apps_v1_StatefulSet_kind": "StatefulSet",
        "io_k8s_api_apps_v1_StatefulSet_metadata": {
            "io_k8s_api_apps_v1_StatefulSet_metadata_labels": [
                {
                    "io_k8s_api_apps_v1_StatefulSet_metadata_labels_KeyMap": "node.type",
                    "io_k8s_api_apps_v1_StatefulSet_metadata_labels_ValueMap": "es-node-master"
                }
            ],
            "io_k8s_api_apps_v1_StatefulSet_metadata_name": "es",
            "io_k8s_api_apps_v1_StatefulSet_metadata_namespace": "logging"
        },
        "io_k8s_api_apps_v1_StatefulSet_spec": {
            "io_k8s_api_apps_v1_StatefulSet_spec_replicas": 1,
            "io_k8s_api_apps_v1_StatefulSet_spec_selector": {
                "io_k8s_api_apps_v1_StatefulSet_spec_selector_matchLabels": [
                    {
                        "io_k8s_api_apps_v1_StatefulSet_spec_selector_matchLabels_KeyMap": "node.type",
                        "io_k8s_api_apps_v1_StatefulSet_spec_selector_matchLabels_ValueMap": "es-node-master"
                    }
                ]
            },
            "io_k8s_api_apps_v1_StatefulSet_spec_template": {
                "io_k8s_api_apps_v1_StatefulSet_spec_template_metadata": {
                    "io_k8s_api_apps_v1_StatefulSet_spec_template_metadata_labels": [
                        {
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_metadata_labels_KeyMap": "node.type",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_metadata_labels_ValueMap": "es-node-master"
                        }
                    ]
                },
                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec": {
                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers": [
                        {
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_name": "fix-permissions",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_image": "busybox",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "sh"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "-c"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "chown -R 1000:1000 /usr/share/elasticsearch/data"
                                }
                            ],
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext_privileged": true
                            },
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_volumeMounts": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_volumeMounts_name": "data",
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_volumeMounts_mountPath": "/usr/share/elasticsearch/data"
                                }
                            ]
                        },
                        {
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_name": "increase-vm-max-map",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_image": "busybox",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "sysctl"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "-w"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "vm.max_map_count=262144"
                                }
                            ],
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext_privileged": true
                            }
                        },
                        {
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_name": "increase-fd-ulimit",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_image": "busybox",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "sh"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "-c"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_command_StringValue": "ulimit -n 65536"
                                }
                            ],
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_initContainers_securityContext_privileged": true
                            }
                        }
                    ],
                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers": [
                        {
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_name": "es-node-master-container",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_env": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_env_name": "discovery.type",
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_env_value": "single-node"
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_env_name": "ES_JAVA_OPTS",
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_env_value": "-Xms512m -Xmx512m"
                                }
                            ],
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_image": "docker.elastic.co/elasticsearch/elasticsearch:7.17.0",
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_limits": [
                                    {
                                        "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_limits_asString": "cpu:1000m"
                                    },
                                    {
                                        "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_limits_asString": "memory:2Gi"
                                    }
                                ],
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_requests": [
                                    {
                                        "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_requests_asString": "cpu:500m"
                                    },
                                    {
                                        "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_resources_requests_asString": "memory:1Gi"
                                    }
                                ]
                            },
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_exec": {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_exec_command": [
                                        {
                                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_exec_command_StringValue": "curl"
                                        },
                                        {
                                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_exec_command_StringValue": "localhost:9200/_cluster/health"
                                        }
                                    ]
                                },
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_initialDelaySeconds": 30,
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_readinessProbe_periodSeconds": 10
                            },
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe": {
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_exec": {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_exec_command": [
                                        {
                                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_exec_command_StringValue": "curl"
                                        },
                                        {
                                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_exec_command_StringValue": "localhost:9200/_cluster/health"
                                        }
                                    ]
                                },
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_initialDelaySeconds": 30,
                                "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_livenessProbe_periodSeconds": 10
                            },
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_ports": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_ports_containerPort": 9200
                                },
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_ports_containerPort": 9300
                                }
                            ],
                            "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_volumeMounts": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_volumeMounts_name": "data",
                                    "io_k8s_api_apps_v1_StatefulSet_spec_template_spec_containers_volumeMounts_mountPath": "/usr/share/elasticsearch/data"
                                }
                            ]
                        }
                    ]
                }
            },
            "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates": [
                {
                    "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_metadata": {
                        "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_metadata_name": "data",
                        "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_metadata_labels": [
                            {
                                "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_metadata_labels_KeyMap": "app",
                                "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_metadata_labels_ValueMap": "elasticsearch"
                            }
                        ]
                    },
                    "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec": {
                        "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec_accessModes": [
                            {
                                "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec_accessModes_StringValue": "ReadWriteOnce"
                            }
                        ],
                        "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec_resources": {
                            "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec_resources_requests": [
                                {
                                    "io_k8s_api_apps_v1_StatefulSet_spec_volumeClaimTemplates_spec_resources_requests_asString": "storage:10Gi"
                                }
                            ]
                        }
                    }
                }
            ]
        }
    }
}